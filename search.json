[{"title":"组合计数笔记","path":"/2025/11/23/组合计数/","content":"二项式反演内容记 表示恰好使用 个有标号的元素形成特定结构的方案数， 表示从 个有标号的元素中选出 个元素形成特定结构的总方案数。 将 带入 ： 由 ，即从 个人中选出 个副班长，再从中选出 个班长等价于先选 个班长，再从剩下的人中选出 个副班长。 可得 变形 组合意义： 表示钦定选 个物品的方案数（其余物品随意）， 表示恰好选 个物品的方案数。对于 ， 在 中被计算了 次。 注意 不代表至少选 个物品的方案数，因为其中一些方案会被多次计算。 推广二维二项式反演： 适用于一些二维问题 (? 优化直接反演 太慢了。 我们可以用卷积优化二项式反演使其做到 。 形式一： 拆开组合数，得 ，这是标准的卷积形式，直接 NTT 即可。 形式二： 拆开组合数，得 。 令 ，则 。发现这是一个标准的差卷积形式。 具体地，令 ，，则 即 。直接将 和 卷起来即可求出 。 那么 。 P4491 题意：一共有 种颜色，需要给长度为 的序列染色。给定 ，若出现 次的颜色有 种，将会获得 的奖励。求所有染色方案的奖励和，对 取模（质数）。。 设 表示钦定 个颜色出现 次的方案数， 表示恰好 个颜色出现 次的方案数。则 。 先算 。选出 种颜色 ，再选出 个位置并排列 ，最后由于同一个颜色的位置不能交换，除以 。这 个颜色外的其它颜色可以随便填，。 则 。直接反演是 的，按照上述方法优化即可。 时间复杂度 。 例题错排问题 给定 ，求长度为 的序列的错排数量。 设 为恰好有 个位置错开， 为至多有 个位置错开 容易发现 ，则运用形式一反演可得：。 预处理组合数，时间复杂度 。 P4859 题意：给定长度为 的两个序列 ，将 中的元素和 中的一一配对，求有多少种方案使得 ĵ 的对数比 的对数恰好多 组。 设 表示 的对数，因此 ，解得 。 先将 和 按升序排序。考虑 dp，设 表示 中小于 的元素个数， 表示 已经匹配好，有至少 个位置满足 的方案数。 考虑转移，可以从 转移；另一种是从 转移，因为 是升序的，所以第 位能选的方案数是 。 由于 中我们只考虑了 的位置，其他位置可以随便排，因此设 。 运用形式二反演可得：。答案即为 ，时间复杂度 。 P6076 题意：给定 ，求用 种颜色给一个 的网格染色，使得每种颜色都出现且每行每列都至少被染了一格的方案数。。 做法一：设 表示至多用 种颜色的方案数， 表示恰好用 种颜色的方案数。那么 ，反演得 。 考虑如何求出 。设 表示最多用 种颜色，至多保证 列合法的方案数， 表示至多用 种颜色，恰好保证 列合法的方案数。则 。 考虑到 ，那么 。 ，其中 。 做法二：二维二项式反演。设 是恰好用 种颜色的合法方案数。设 表示用 种颜色染色，至多保证 行 列合法的方案数。设 表示用 种颜色，恰好保证 行 列合法的方案数。 则 ，。 同时我们有 。则 。 故 ，后面那项是因为不合法的方案还包括有颜色没用的情况。 时间复杂度 。 P10681 题意：一个 的矩阵，求有多少种填数方法，使得每行每列的和等于 1 或者 2。。 做法：设有 行和为 1， 行和为 2， 列和为 1， 列和为 2。那么因为是网格图，必有 。故枚举 ，可以得到 。 将这个题转化为组合问题。考虑有 种球，每种球有 1 个，还有 种球，每种球有 2 个；现要将这 个球放入 个盒子，使得：（1）同种球不能放入同一个盒子，（2）恰有 个盒子中有 1 个球， 个盒子中有 2 个球，问有多少种方案。 我们先考虑（2）限制。我们将这 个球进行排列，并钦定前 个放入那些只容纳一个的盒子，后面的放入两个的盒子，注意这里因为是排列所以直接钦定一个放入顺序即可。 再考虑（1）限制。二项式反演，设 表示钦定 个盒子有 2 个同种类球的方案数， 表示恰好 个盒子有 2 个同种类球的方案数。 。反演，。 最后，我们发现，考虑完限制（1）后，一个装着两个球的盒子里的球交换后会被算重，那么需要乘上 。 所以答案就是 。时间复杂度 。 CF285E 题意：求有多少个长度为 的排列 ，使得恰好存在 个位置满足 。。 做法：排列很难，但是题目里的限制很强，因为 要求 或者 ，基本上就定死了 ，那么我们考虑用二项式反演去忽略掉除了“好位置”以外的位置。 设 表示钦定 个好位置的方案数， 表示恰好 个好位置的方案数。那么 。考虑怎么去求 。 设 表示前 位，有 个好位置。考虑到前面的位置可能会占用 ，故修改状态为 表示前 位，有 个好位置，是否占用了 ，是否占用了 。注意这里因为我们求的是 ，因此不是好位置的位置不应该填数，那么 。 转移如下：第 位是好位置： 第 位不是好位置： 最后反演一下就行了。时间复杂度 。 斯特林数第一类斯特林数记号： 定义：将 个元素分成 个环的方案数（环旋转后算同一个） 解释：考虑可以新建一个环 ，也可以在某个环中间插入，环长和为 ，总插入点个数为 ，方案数为 。 恒等式： 证明：考虑一个置换会被拆分成若干个轮换（环），枚举环的个数再求和就是置换的个数。 上升幂 证明一：考虑归纳法。。 证明二：考虑第 行斯特林数的生成函数 。那么根据递推式，。因此 。 我们可以快速地求出同一行的第一类斯特林数。 根据上述结论，有 ，我们如果能快速地求出 ，那么就可以倍增地求出同一行的第一类斯特林数。令 。 这是个标准的差卷积，直接把 倒过来和 卷起来即可求出 的系数。 时间复杂度 。注意 是奇数时需要暴力把 卷起来。 下降幂 。 证明：。 第二类斯特林数记号： 定义：将 个元素划分成 个集合的方案数 解释：考虑可以新建一个盒子 ，也可以丢进之前的一个盒子 。 恒等式： 证明：考虑组合意义。 代表将 个不同球放入 个不同盒子的方案数。那么，我们枚举非空的盒子个数 ，并将这 个球放入这 个盒子 ，同时选出这 个非空的盒子 并排列 。 推论： 证明：。 由组合恒等式 （考虑在 个数中选出 个，枚举最大的那个数 ，然后在 的数中选出 个）可得 。 可以使用卷积优化二项式反演快速求出同一行内的第二类斯特林数。 令 ，，则 。 则 ，直接 NTT 即可。"},{"title":"动态规划笔记","path":"/2025/11/20/动态规划笔记/","content":"排列计数/计数 DP排列计数是很困难的，因为不能状压，无法知道还有哪些能用。我们可以： 钦定一个顺序插入每个数 考虑每个数放入哪个位置（根据一些限制） 连续段 dp：任意时刻的排列可以划分为若干个连续段，每次插入一个数可以新开一个段、连在某个段前/后面、合并两个段 枚举最大值最小值转移：类似笛卡尔树分治 直接组合计数乱斗 P2467洛谷 枚举最大最小值转移。发现第一个是峰和第一个是谷的序列一一对应。设 表示 的答案。考虑递推，发现 只能是峰，枚举它插到序列的位置（显然只能是奇数），则 ，因为分成左右两边之后它们的相对大小关系是不变的。 D92nu. 排列苹果清澄 题意：给定 种苹果，第 种苹果有 个求排列这 个苹果且同一种苹果不相邻的方案数。。 不是很难。设 表示前 种苹果，有 个连续段的方案数。转移时，枚举第 种苹果此时被分成了 个连续段，以及将之前的连续段拆分而额外形成了 个连续段。容易发现，用于拆分之前连续段的新连续段应该插在之前的某个连续段中间；而其余的应插在某两个连续段的空隙中。 那么考虑怎么从 转移到 。 将 个苹果分成 个连续段，有 种方式。 由于上面的选法已经排列好了这些连续段，可以钦定前 个连续段用于拆分之前的连续段，有 种方式，其中 ，这里是 是因为之前的每个长度为 的连续段有 个空隙，总共有 个空隙。 选择 个插在某两个连续段中间，有 种方式。 故转移为 。 时间复杂度 。 P5299洛谷 我们先来考虑什么是最优策略。将强化卡 ，攻击卡 从大到小排序。 设此时用了 张强化卡， 张攻击卡。我们考察如果多使用一张强化卡，是否会更优： 移项相减： 注意到题目给定 ，而 是单调不增的，故上式恒成立。也就是说，我们要尽可能多地使用强化卡。感性理解一下，由于你从大到小排序 ，你多使用一张强化卡能让之前大的 翻倍，比添加一个比之前小的 更优。 我们枚举选出的 张强化牌，那么根据上面尽可能多选强化牌的策略，我们可以算出实际使用的强化牌数量 和使用的攻击牌数量 。我们设 表示 前 个数选出 个的乘积和， 表示 前 个数选出 个的和的和。 我们确定了使用了多少强化牌和多少攻击牌，但是选出来的强化牌/攻击牌不一定都能用上。那么剩下的问题就是：给定选出了 个强化牌/攻击牌，使用了其中 个的贡献和。 先来算强化牌。我们枚举使用的最后一个使用的强化牌的位置是 ，那么我们钦定 必须选，前面需要选出并使用 个，后面需要选出但是不使用。方案数 。 攻击牌同理，攻击牌的数量为 。 所以，最后选出 张强化牌的方案数就是 。 答案即是 。时间复杂度 。 P8321洛谷 我们把 序列染成黑色， 序列染成黑色，再把 拼成序列 并从大到小排序。那么，问题转化为，在 中选出 对黑白对的答案和。 设 表示前 个人，配对了 对的答案和。我们考虑每一对数，只在较小也即下标靠后的地方记录贡献。那么，，其中 是前面与 异色的数的个数。 ABC313ExAtCoder 连续段 dp。 考虑如何判定一个排列是否可以。不妨设 ，令 ，那么对 排序，即要求 。 一个时刻的序列可以看做若干连续段。那么我们把 排序，从小往大考虑每个 塞到哪里，可以无后效性地考虑，不会把之前的连续段变得不合法。 设 表示前 个数，有 个连续段的方案数。转移时，我们考虑： 新开一个段，并塞到两个段中间 ，则此时我们新添加了两个 ，要求 ，因为长度为 的连续段会产生 个 限制，总共为 个。 添加到某一个段的开头/末尾 ，必须满足 。 合并两个连续段，，此时我们没有新的 限制。 时间复杂度 。 P9197P9197 连续段 dp。 从大到小插入每个数，可以消除绝对值的影响。具体地，我们画出这个排列的折线图，并从上到下“扫描线”。 那么，如上图红线，从 到 新产生的贡献即为 连续段个数（这里需要特别注意左右连边界是否取到了，取到一个减一个）。 那么设 表示前 个数，有 个连续段，贡献和为 ，是否取到了左右边界。 令 ，转移时我们可以（这里不考虑边界）： 新建一个连续段，由于不考虑边界，需在两个段中间新建： 延续某个连续段： 合并两个连续段： 时间复杂度 。 延迟决策技巧P14364洛谷 贡献延迟计算。 我们先设 表示前 个人，有 个人跑路的方案数。对着排列数数，显然不好做，此时应用贡献延迟计算，我们发现每个人的 是唯一的，而每个人是否能被招聘和 是否 有关。故我们令每个人的贡献只在 时计算，即当 时，计算 的贡献。 修改状态为 表示前 个人，有 个跑路， 个人 的方案数。 令 。 对 进行分讨： ，则 必然招聘不上， 必然 ，那么我们此时要统计 的贡献，并考察 与 的大小关系： ，枚举 的个数 ，，其中 是为了给当前位置选定一个 且未在序列中出现过的人。 ，枚举 的个数 ，，这里是 是因为新选的这个数不可能满足 。 ，考察 与 的大小关系： ，枚举 的个数 ，。 ，。 注意 ，时间复杂度 。 P7213洛谷 贡献延迟计算。 我们发现，每次同一个高度的石柱永远不会消失，因为能够震掉一个高度的石柱，右边必定存在一个和它相同的。同时，每次只会震掉一个高度为 的柱子，因为考虑每个高度同一时刻最多存在两个，如果高度为 的柱子还有两个，则会将其中一个变为 ，重复这个操作，不难发现，除了最后一次地震外，高度为 的柱子永远有两个。那么，我们发现，无论初始怎么排列，最后剩下的永远是 各一个。 记第 个石柱的高度为 。我们从右往左考虑每个石柱最终高度是多少。每个最终高度至多存在一个，因而，它的高度会一直减小直到右边没有和它重复的，或者它的高度减小到 。 我们尝试把这个问题从若干轮整体操作转化为从右往左依次操作。设 的初始高度为 ，则 若 中出现了 ，那么 。 否则， 为 中最大没有在右边出现过的数。 设 表示从右往左第 个石柱，且右边连续的高度为 的方案数。我们这里暂且认为高度相同的是两个不同柱子，最后输出的时候除 即可。 考虑从 转移到 。我们令 表示从 中有多少个位置需要变成 ， 表示有多少个位置需要保留。 对于第 个位置： 若最终它要被震掉，则 的初始高度 。一共有 个可选的高度，而右边 个位置中，需要选出 个被震掉了的，这些初始高度一定 。同时，因为我们右边 都出现过，那么必然有 个高度为 的柱子，初始高度 。考虑这是为什么，因为没有高度为 的柱子，那么高度 的柱子永远无法跨过 这个高度，也就无法成为 的柱子。所以，我们还需要分配 个初始高度给 。所以，一共有 个可选初始高度。。 若最终它不用被震掉，我们考虑 与 的大小关系： 若 ，则连续高度依旧为 ，我们扔到后面考虑贡献，。 若 ，枚举新构成的连续高度 。此时我们需要计算右边 在 内的这 个柱子贡献。 选定右边这 个柱子的位置 。 给 分配初始高度。根据第一种情况中的分析，初始高度 必须满足 ，而需要分配 个初始高度给右边 在 内的柱子。所以系数为 。 给那 个柱子分配初始高度。问题转化为，将 个柱子高度震为 这连续 个高度的初始高度方案数。设其为 。考虑转移 。 枚举最左边的柱子的最终高度 。那么其初始高度 ，共有 种，但是要给最终高度在 中的 个柱子留下位置，故有 种初始高度。而此时，我们将这些柱子按照最终高度分为 和 这两个子问题，容易发现它们因为无法跨过 高度而互不影响。故 因此， 转移即可，时间复杂度 ，最后记得除以 。 这道题中，我们延迟决策了右边 的柱子，等到后面拼接成一个更大的连续段时再决策，利用了 和 这两部分柱子互不影响的性质。 CF285ECodeForces 排列很难，但是题目里的限制很强，因为 要求 或者 ，基本上就定死了 ，那么我们考虑用二项式反演去忽略掉除了“好位置”以外的位置。设 表示钦定 个好位置的方案数， 表示恰好 个好位置的方案数。那么 。考虑怎么去求 。 设 表示前 位，有 个好位置。考虑到前面的位置可能会占用 ，故修改状态为 表示前 位，有 个好位置，是否占用了 ，是否占用了 。注意这里因为我们求的是 ，因此不是好位置的位置不应该填数，那么 。 转移如下：第 位是好位置： 第 位不是好位置： 最后反演一下就行了。时间复杂度 。 背包P1800洛谷 题意：给你两个软件，每个软件有 个模块，要求把这些模块都做完。同时有 个人，每个人完成一个模块的时间的时间分别为 ，且每个人不能同时做两个模块，但多个人可以同时工作。求完成两个软件的最少天数。。 正常背包的话肯定是设 表示前 个人，做了 个模块一， 个模块二，的最少时间，那么状态数 ，转移是 的，肯定超了。 那么考虑怎么吞掉一维。我们交换背包的第三维和答案，即把天数塞到第三维， 表示前 个人，做了 个模块一，还剩 天，能做的最多模块二数量。但是我们发现其实如果总天数固定，那么 是可以由 所做的模块一数量算出来的。具体的，设总时间为 ， 做了 个模块一，那么他最多做 个模块二。于是我们就可以枚举/二分总时间。 那么转移就有了， 表示前 个人，做了 个模块一，能做的最多模块二数，则 ，最后二分 即可，时间复杂度 。 LOJ 6089LOJ6089 考虑根号分治，对于体积小于 的物品，我们直接背包做，注意每种物品有选的个数上界，需要容斥一下。 对于体积大于 的物品，每种物品相当于没有数量限制。 设 表示选了 个 物品（并非种），总体积为 的方案数。转移时，我们可以： 添加一个体积为 的物品 使已选的所有物品体积 +1 时间复杂度 。 这里我们采用了一种新的思路，利用了每种物品都有的特性。两种转移分别对应了下面的绿色块和红色块。可以证明所有这种填块方式可以代表所有选物品方案。 双倍经验：P6189 区间 DPUVA1437洛谷 区间 DP。对于区间 ，若 和 相等，则可以在刷 中覆盖 的那次操作右端点延伸到 ，并将前面的操作移到后面去，所以此时 。其他情况照常转移。然后考虑先对 b 进行这个 DP。对于 a，设 表示前 位的答案。那么类似的，若 ，则 ，否则照常转移。 UVA10559洛谷 区间 DP。设 表示区间 的收益。我们枚举最后一次消除，暴力的转移是：同色。显然为 的。考虑怎么优化后面的式子。发现它特别像序列划分的问题，考虑使用序列 DP。设 表示在区间 中选了 个关键点，且第 个求必选的收益。 与同色 。 时间复杂度 P5356洛谷 区间 DP。和 UVA10559 一样的套路，枚举最后一次选的点，那么序列被划分为了若干选/未选交错连续段。设 表示完成 的最小代价；设 表示 区间内没选的数最大最小值为 的最小代价。则 有两种转移：新填一个已选的段或添加一个未选段。第一种转移即添加 ，第二种转移可以视为 。最后，处理最后一次操作， 就是 。离散化后，时间复杂度 。 杂题P8100洛谷 题意：给你一堆数，每次可以选择相邻两个差为 的数并交换它们，问最终能产生多少种不同的序列。 很显然差 的两个数永远无法跨过对方，即它们的相对顺序是固定的，而其它数没有任何要求。 于是，我们将 连一条 的边，这样就产生了一个 DAG，而我们要满足最后的序列满足这个 DAG 的拓扑序。这就转化为了 DAG 拓扑序计数问题，而这是一个 NPC 问题，因此我们要挖掘一些图的性质。 注意到这里我们的限制是差 ，而如果把所有奇数分成一组，偶数分成一组，则组内的任意两个数必定存在一个限制，也即组内的拓扑序是固定的。 所以现在，我们可以认为这就是一张二分图，左部点和右部点内部的相对顺序是固定的，要进行拓扑序计数。直接 DP 即可。 P2059洛谷 我们没必要记录环长什么样，只需要记录相对位置，令 表示还剩 个人，庄家是 ，从庄家开始第 个人赢的概率，直接枚举抽到的牌 ，根据 和 的位置算出 在新环中的位置即可转移。 P2519洛谷 题目所给的条件相当于 是第 名，且有 个人和它同分，那么他的分数就占据了第 个名次，令这个区间为 。那么，对于左右端点都相同的一些人，设他们的区间为 ，可以认为这个区间的价值就是这些人的数量（当然，最多为 ）。那么问题转化成了，有 个区间 ，每个区间有价值 ，让你从中选一些不交区间，使得价值最大，直接 DP。 P4155洛谷 先按照左端点排序，并断环成链（复制一份）。则区间传递的时候一定是编号连续的一段。考虑倍增， 表示从区间 出发走 步到达的区间。 直接双指针扫一遍就行。查询直接跳就行。 CF908G洛谷 数位 dp。方法一：拆贡献，对每个数字 单独计算贡献，考虑 表示前 位对 的总贡献以及若加入了一个 ，能产生的新贡献。枚举填入的数 。转移 ：若 ，则 ，即把前面的所有 左移一位；若 ，则 ；若 ，则 。 转移 ：若 ，则 ；若 ，。 注意我们这里需要枚举到 位。 方法二：拆贡献，把每个数拆成若干个 的和，对于一个数字 ，如果有 位 ，则贡献为 （ 个 ）。设 表示从底往高数前 位，有 个 的贡献。 P9129洛谷 数位 dp。差分一下，记 每一位构成的序列为 。我们考虑将这个问题转化成用拼成的数与 匹配，记 表示 中选出了 个数，且与 的大小关系（小于/等于/大于）。那么我们可以把 接在前面： 也可以接在后面： ，其中 是 与 的大小关系 边界： 其中 是 与 的大小关系（因为可以在前面/后面添加 ） 答案： 最后对 滚动即可。 P2279洛谷 树形 dp。考虑在状态里记录向上（向下）能延伸几层，即能完全覆盖孙子/儿子/自己/父亲/爷爷。 OIFC 2025.11.4 T1题意：你有一个长度为 的序列，你每次可以在一个空位置填 ，问让 出现次数都为奇数的序列有多少个，。 做法：我们可以考虑给数放位置，也可以给位置填数。对于前一种方式，我们发现我们需要知道前面用了多少位置，状态是二维的，转移一维的，不行。对于第二种方式，设 表示前 个位置，有 个奇数，直接转移即可。时间复杂度 。 线性做法：使用 OGF，优化前面那种 dp。设 表示前 个数都合法，用了 个位置的方案数。， 为奇数，拆开组合数，，变成了 OGF 的形式。 OGF： 。常用公式：，用泰勒展开即可。 那么对于本题，（ 为奇数）即是 。那么 dp 式子即是将 变成 。答案即是 ，乘上 是因为 可以随便填。 后面的 拆开，即是 ，然后答案就是 ，直接算即可。 P5479洛谷 串串计数。 我们首先枚举 拿来匹配的子串的开头。我们不能直接 地暴力 dp，但是我们观察到 很小，故考虑把操作数放到维度上而不是匹配长度。但是我们此时发现，我们不知道匹配到哪了，因此还需维护匹配的串上进行的添加操作数减去删除操作数，这样就可以知道匹配到哪了。 设 表示使用了 次操作，在 上添加了 的长度（即添加操作数减去删除操作数），能用 的前 位匹配 的前 位。 转移使用刷表。 首先， 可以往前拓展 位，直接二分哈希。 替换：，因为相当于往前匹配了一位。 删除：，因为虽然删除了一位，但是匹配位数不变。 添加：，因为虽然添加了一个点，匹配位数添加一位，但是 没往前走。 注意要求最小操作次数，加答案的时候遇到 是 就 break 掉。 时间复杂度 。"},{"title":"图论笔记","path":"/2025/11/19/图论笔记/","content":"最短路记录一些奇奇怪怪的最短路。 OIFC 2025.11.11 T2题意：给定一张有向图，第 条有 个限制 ，表示经过编号为 的这些边后，不能立刻经过 。。 将图上的边视为点跑最短路，同时把边权化为点权。显然过不去，因为是 的。 但是我们考虑，在这个新图上跑 dijkstra 满足，一个边点被其它点松弛时，所加的“边权”实为它的点权，所以都是一样的。这就意味着这个边点只会被松弛一次，即将这个边点加入优先队列后必定不会再被其它边点松弛到。那么我们松弛成功一个点后可以直接原图中删除这个边点。 所以我们每次到一个边点的时候，去尝试松弛它的出边，只会尝试松弛 次。每次松弛成功一个边点，直接把这条边从原图中删除。 时间复杂度 。 P4042洛谷 我们令 为消灭 后新产生的怪物所构成的可重集。 考虑一个类似 的转移：设 表示消灭 的最小代价，则 。但是这是一张图，直接 是有后效性的。 我们考虑，这个式子很像最短路松弛。由 向 连边。可以发现，一个点的值当且仅当它的入边另一端的值都确定了之后才会被确定，而且它的值一定会 入边另一端的值。如果我们模仿 dijkstra 的贪心策略，每次选择 值最小的点对它的出边进行更新，那么如果一个点的值是当前最小的，它一定不会被更新了，直接弹出这个点。这样每个点最多被松弛成功一次。这里松弛成功指的是，它的所有入边都对它进行过贡献了并且新的 值更小。 故我们对 值建一个小根堆，每次对它的出边进行更新，如果更新到一个点松弛成功了，那么把它加入堆。 每个点最多进入堆一次。时间复杂度 。 P2446洛谷 仿照上面那题的思路，设 表示第 个点不考虑自己的限制的最早到达时间， 表示解决完限制不考虑原图的最早到达时间，那么第 个点的实际到达时间为 。直接 dijkstra，对于边 ，拿 ；对于限制 ，。若一个点被限制都更新过了，将其加入队列。 P6961洛谷 我们枚举一条边，并钦定它是第 大。设这条边的权值是 ，我们将 的边边权设为 ，将 的边边权设为 ，直接跑最短路，则我们认为 为这次钦定的答案。 考虑这个答案和实际答案的关系： 若这条边就是第 大的边，则答案就是实际答案。 若这条边为第 大的边，则这时候等价于第 大的边边权不变， 大的边边权变大为 ，故答案 实际答案。 若这条边为第 大的边，则有一些不用支付费用的边支付了，故答案还是 实际答案。 综上所述，我们这么跑出来的最短路始终大于等于实际答案，而由于我们只要经过的边数 ，则一定有第 大的边，因此一定有一次求出了实际答案。 最后，如果我们经过了 条边，直接在原图上跑最短路并取 即可。 时间复杂度 。 P3645洛谷 我们将一个状态表示为 ，表示当前在 ，跳跃能力是 。我们考虑根号分治： ，则一共有 个这种状态。 ，则对于每个 对应的 doge，它能到达的地方有 个，则这种状态一共有 种。 那么直接 bfs 就行了，时间复杂度 。注意第一次到达 时将其上的所有 doge 加入队列。去重使用bitset可以做到空间 。 图上组合问题D9ahh. 朝花夕拾清澄 拆贡献，对于每个点计算它期望的操作次数。我们发现这个点不用操作当且仅当它周围的点都在它之前染了。把这个染色顺序看为一个排列，即要求它在排列中的位置在这些点之后。设其度数为 ，则满足要求的排列概率为 。故这个点被操作次数期望为 。答案即为 。 图上随机游走P3232洛谷设 是每个点的期望经过次数， 是每个边的期望经过次数。 不妨 。，直接高斯消元。 设第 条边是 ，则 。直接按照 给边排序， 越大的编号越小。答案即为 。 时间复杂度 。"},{"title":"贪心笔记","path":"/2025/11/15/贪心笔记/","content":"开胃菜P1106 删数问题对于每个位置 ，直接选取右边能选取的最小值位置 ，把 都删了。 P1205 种树 模型：给定若干限制 表示在 中至少选 个数，求最少选多少个数。按照右端点排序，每次覆盖区间末尾若干个点。 P6155 修改我们希望修改的地方尽可能集中，这样才能尽肯能使用较小的 。那么我们从大到小遍历 ，设 为 后面第一个空位， 可以用类似并查集的方法处理。处理出每个位置修改的次数。根据排序不等式，肯定是用小的 去搭配修改次数多的地方。 P4801 饥饿的狐狸最小值直接从小到大吃，最大值每次贪和它差的绝对值最大的吃。 P2127 序列排序把每个点需要到达的位置处理出来，则构成了若干个环。对于每个环，设其环长为 ，交换环内两个数最多只能拆出一个环，而我们最终要拆出 个环，则至少操作 次，而每个环内每个数至少要被操作一次，那么拿环内最小值和环内其它数挨个交换即可。但是注意到可以把别的环的最小值拿过来用，拿过来的一定是全局最小值，直接取个 min 即可。 P3615 如厕计划每次上厕所相当于进行如下操作： 若队头是女生，删掉队头的两个人（无论性别） 否则，删掉队头和队列里下一个女生 由于有 个时间和 个人，每一时刻两个厕所都必须是满的，那么进行操作 2 时必然有女生仍在队列里。我们发现这个限制相当于对于每个男生，其后面都有女生仍在队列里。 我们从后往前考虑，对于一个后缀区间，其中的男生数-女生数 。令男生是 ，女生是 。那么对于一个后缀区间，其的和必然 。 现在我们考虑如何可以让这个序列变得合法。我们把后面的男生往前移，这样能够让后面的后缀和都 ，且让答案 （因为相当于在现在的位置和原来的位置之间的女生后移一位）。所以说我们的答案就是最大的后缀和 ，从后往前扫一遍即可。 CF1693F I Might Be Wrong我们不妨钦定操作的区间 ，因为如果小于，则可以对该区间每个数取反并从右往左考虑，且一定可以映射到原序列的一个操作区间。 考虑证明如下贪心：每次选择 的区间进行操作。事实上，我们要证明的即是，对于操作的一个 的区间，一定可以拆分成总代价不超过 的若干 的操作区间。那么我们的目标即是，通过不多于 次操作使得前缀 的个数 ，这样只需要再进行一次后缀 的操作就能完成任务。考虑到，我们每次选择一个 的区间进行操作，必然能够使后面的一个 跑到前缀中。设一开始前缀 个数为 ，则进行 次操作后，前缀 的个数必定 ，最后再一波带走后缀的一个 的区间，代价 ，故证毕。 有了这个结论，我们就可以实现这个贪心了。具体地，我们只需维护前缀 的个数 ，则操作的左端点即为 ，然后我们再令 为最大使前缀 的位置，那么每次令 ，即对 进行一次操作，同时使前缀 个数增加 。 邻项交换模型与排序在一些序列贪心与顺序决策问题上，我们考虑交换相邻两项在什么条件下会更优。则按照这个条件对序列排序，便可得到最优方案。 P14361 CSPS2025T1只有一个部门会超过 ，若把处在同一个部门的人连续排在一块，则不交换处在交界处（不同部门）的人 必定满足 ，其中 是次大值，移项，即按 排序。 P1080 国王游戏设相邻两个人为 ，若交换 更优，必有 。由 ，必有 ，即 ，那么不交换的话就是按照 从小到大排序。 P3619 魔法先把 的做了。对于 的任务，如果我们交换 ，使得做任务的顺序从不合法变得合法了，必定有 且 ，有 ，移项，我们要保证不能进行交换，即按照 从大到小排序即可。 P3574 [POI 2014] FAR-FarmCraft 表示使 及其子树内都玩上的最短时间。设 的儿子分别为 ，则 。那么考虑决定 的顺序。邻项交换，，得 ，即按照 排序转移即可。 P2123/P1248 皇后游戏/加工生产调度 引理：在邻项交换模型中，若最优条件是 ，则按照 排序一定优。 证明：若 ，则交换 ，一定满足 。 在本题中，若交换相邻两项 更优，令 ，则必然有 。 拆开，即得 。 应用引理，得 ，即 。 移项，得 ，即 。 那么最终按照 排序即可。但是注意到若 相等，则我们的排序方式不满足不可比的传递性，相等时直接按照 从小到大排序即可。 借鉴这篇博客。 反悔贪心在每一步贪心决策的时候，加入可以反悔的决策。 P2949 [USACO09OPEN] Work Scheduling G先按照截止日期排序。从左往右扫，遇到一个任务就把它做了，并把价值压入一个小根堆。遇到一个无法做但是价值比堆顶高的工作时，就舍弃堆顶工作并做这个工作。 P4053 建筑抢修仿照上面那题的思路，按照截止日期排序。遇到一个任务就把他做了，并把使用时间压入一个大根堆。遇到一个无法做但是时间比堆顶低的任务时，就舍弃堆顶任务并做这个任务。 P1792/P3620 [国家集训队] 种树/数据备份种下一棵树时，我们放弃了旁边两棵树的权值，因此，我们若要反悔，即新建一棵旁边两棵树价值-自己价值的树并加入考虑，这课新的树左右分别即为自己左边的左边和自己右边的右边，直接链表维护。 CF436E Cardboard Box我们有一个显然错误的贪心：往小根堆里加入所有 的 。在选取 时，把 加入。错误的原因很简单：由于 对 的依赖性，我们可能忽视了 很优但是 很劣的关卡。 那么在每次决策时加入反悔贪心： 将一个二星关卡变为一星，并将一个零星关卡变为二星。 将一个一星关卡变为零星，并将一个零星关卡变为二星。 加上原来的两种操作，我们每次有四种决策： 开五个优先队列分别维护 即可。"},{"title":"最小斯坦纳树","path":"/2025/11/13/最小斯坦纳树/","content":"题意给定一张 个点 条边的图，以及 个关键点，求使这 个关键点连通的子图的最小边权和。 。 最小斯坦纳树算法首先答案的子图必然构成一棵树，因为若不是的话可以一直通过删边直到成为一棵树，并且依然连通。 那么我们设 表示以 为根，使 集合内的关键点连通的最小代价。 转移有两个： 从节点 继承连通性，花费 ，即 。 从已经连通的子集转移，即 。 对于第一种转移，发现其转移式类似最短路松弛操作，可以用 Dijkstra 最短路转移，时间复杂度 。 对于第二种转移，枚举子集 ，时间复杂度 。 总时间复杂度 。 #include bits/stdc++.husing namespace std;const int N = 105, M = (1 10) + 5;struct Node { int v, w; bool operator (const Node r) const { return w r.w; } }; vector Node e[N];int n, m, k, f[N][M]; priority_queue Node q;void dijkstra(int mask) { while(!q.empty()) { int u = q.top().v; q.pop(); for(auto x : e[u]) { int v = x.v, w = x.w; if(f[v][mask] f[u][mask] + w) { f[v][mask] = f[u][mask] + w; q.push({v, f[v][mask]}); } } }}int main() { scanf(\"%d%d%d\", n, m, k); while(m--) { int u, v, w; scanf(\"%d%d%d\", u, v, w); e[u].push_back({v, w}); e[v].push_back({u, w}); } memset(f, 0x3f, sizeof(f)); for(int i = 0; i k; i++) { int x; scanf(\"%d\", x); f[x][1i] = 0; } for(int mask = 0; mask (1 k); mask++) { for(int i = 1; i = n; i++) { for(int mask2 = mask; mask2; mask2 = (mask2 - 1) mask) f[i][mask] = min(f[i][mask], f[i][mask2] + f[i][mask^mask2]); if(f[i][mask] 0x3f3f3f3f) q.push({i, f[i][mask]}); } dijkstra(mask); } int ans = INT_MAX; for(int i = 1; i = n; i++) ans = min(ans, f[i][(1k)-1]); printf(\"%d \", ans); return 0;} 例题WC2008 游览计划：把边权变成点权即可，注意 需改为 。"},{"title":"生成函数笔记","path":"/2025/11/05/生成函数笔记/","content":"生成函数入门对于无穷数列 ，其生成函数 。记号 表示 项的系数，也即 。 那么，它就有好多性质。考虑这样一个问题：我们有 个背包，对于第 个背包，它有能够选若干数，而选 个数的方案数 。那么我们就可以为这个背包考虑其生成函数 。现在，我们要在这 个背包中选总共 个数。那么，答案就是 ，即将这些背包卷起来。 一些常用性质： ，因为 ，因为考虑其组合意义，即为 的非负整数解个数，插板即可。 P1450 [HAOI2008] 硬币购物题目传送门 题目描述共有 种硬币。面值分别为 。 某人去商店买东西，去了 次，对于每次购买，他带了 枚 种硬币，想购买 的价值的东西。请问每次有多少种付款方法。 。 做法考虑第 个硬币的生成函数，。 那么，把这四个硬币的生成函数卷起来，答案即是 。 考虑后面那个求积是什么，其本质就是去掉了 的限制，也即 个物品的完全背包。 那么最后要做的就是算出前面的 ，直接暴力 算，然后和预处理的完全背包再卷一下即可。时间复杂度 。 推广有 种物品，每种物品有重量 和个数 ，问拼出重量为 的方案数（同种物品视为相同）。 将每种物品的生成函数写出来 。 令 。 可以得到 。而 可以由完全背包直接 求出，而后面减去的即是完全背包完集体后移 项得到的，直接前缀和优化一下即可做到 。所以每次拿原来的生成函数拿来做一次完全背包然后再应用上述算法即可。 代码长成这样： f[0] = 1;for(int i = 1; i = n; i++) {\tfor(int j = 0; j = k; j++) { sum[j] = f[j]; if(j = w[i]) (sum[j] += sum[j-w[i]]) %= mod; }\tfor(int j = 0; j = k; j++) if(j w[i] * (a[i] + 1)) f[j] = sum[j]; else f[j] = (sum[j] - sum[j-w[i]*(a[i]+1)] + mod) % mod;\tmemset(sum, 0, sizeof(sum));} LOJ 6077LOJ 6077 题意：求长度为 ，逆序对数为 的排列个数。。 其实难点在 dp。dp 套路来源于 LOJ 6089。 从小到大挨个插入 ，则 可以产生 个逆序对。 那么 的生成函数为 。把这 个函数卷起来，答案即为 。分母即为 。 重点即为求 。考虑其组合意义，即为在 中选若干个数使其和为 ，且若选出的为奇数个数，则贡献为 ，否则为 。 设 为选了 个数，和为 的贡献。转移为： 使选的数都 使选的数都 ，并新选一个 。 注意此时第一维是 的，整个 dp 即是 的。 此时有可能选了 的数，那么对于 。 则分子中 次项系数即为 。"},{"title":"政治学笔记","path":"/2025/10/19/政治学笔记/","content":"第一单元 政治的概念古今中外各种政治思潮最核心的区别在于对政治的概念的不同理解“政治”一词在我国古代：政事得以治理在我国近代，政治一词由中国传入日本，再传回中国 希腊语polis（城邦）地域概念转化为人的概念 亚里士多德（理想主义）： 至上性：其他科学都为其服务决定其他科学的目的 公共性：治理平等自由人城邦是共同体（有机体理论）政治只处理公事，追求最高的善人在本性上是政治的动物 政治与理性演说 总结：管理众人的事 由众人参与 以正当形式行使 现实主义韦伯（社会学创始人之一）：经济的繁荣不代表政治的强大 政治在本质上关乎民族国家的生存权利施密特（批判自由主义）：政治划分敌，团结朋友打击敌人 认为总有冲突无法通过协商解决 国家内政问题转化为法律问题 政治的核心：服从的道理和反抗的缘由 第二单元 政治学科历史传统政治学 古希腊和古罗马希罗多德 《历史》三种政体修昔底德 《伯罗奔尼撒战争史》政治演说柏拉图 《理想国》正义 政体 德行 教育亚里士多德 《政治学》《尼各马可伦理学》政治科学斯多葛学派 克里斯波斯、帕那提乌斯 普世人类和自然法 自由主义的渊源波里比乌斯 政体循环与混合政体西塞罗 混合政体与自然法 中世纪奥古斯丁 自由意志：人对自身行为负有道德责任托马斯阿奎那 混合政体与自然法文艺复兴和启蒙运动：马基雅维利《君主论》《论李维》：现实主义政治；共和观念主权学说：让布丹《国家六论》托马斯霍普斯 《利维坦》《论公民》利维坦、自然状态与新公民约翰洛克 《政府论》自然状态权力与分权孟德斯鸠 《论法的精神》政体、分权制衡 政治科学 19世纪 科学方法的勃兴历史主义与进化论孔德和圣西门 历史实证主义：神学-玄学-科学赫伯特斯宾塞：社会进化论梅因：古代法和现代法韦伯和涂尔干：现代理性与传统 有机聚集与机械式聚集 20世纪 政治科学的专业化芝加哥学派 哈罗德拉斯威尔 第三单元 政治学概论社会科学：社会学、经济学、政治学构成了以国家为中心的三位一体，研究普遍规律 政治学学科的发展中世纪：神学医学法学哲学1880 美国哥伦比亚大学政治研究院 现代政治学学科独立的标志1903 美国政治学会成立。《美国政治学评论》创刊，表示着政治学科的大体确立中国：1903 京师大学堂（北京大学）中国最早开设政治学课程钱端升1952 院系调整 中国大学取消政治系1979 改开 邓小平支持政治学研究1980 成立中国政治学会中国政治学现状：受地方权力、商品经济的影响 政治学基本框架主要领域：政治理论，政治制度，政治行为，比较政治学，国际关系，公共政策与行政，政治经济学，政治学方法论政治理论：描述性方法规范性方法（是什么和应该是什么） 制度主义，行为主义，理性选择，马克思主义，女权主义交叉学科：政治哲学 政治哲学关心的核心问题是治理 认同问题 宗教与政治、民族主义、自由主义、群体主义 政体问题，政治制度问题 民主共和权威主义 公共政策问题 公平正义 政治经济学 国家对经济事务的管理 经济制度对国家的影响政治社会学 政治对社会的影响和社会对政治的影响 第四单元：政治学研究的方法和视角社会“科学”的起源中世纪：神学医学法学哲学哲学-科学人文法国大革命与社会科学的形成：社会变革成为常态、人民做主成为可能 社会科学的不同视角人文视角： 规范性研究（人与社会应然的研究，应该怎么样） 解析流派（对话语的描述与理解） 科学视角：实证主义（对社会科学的观察与解释） 物质世界与社会世界“社会世界”：关系、权力、民族、国家 存在论、认识论与方法论 实证主义 解析流派 存在论 独立的社会世界 建构的社会世界 认识论 直接观察并解释 理解与深层结构 方法论 定量研究 定性研究 政治学研究视角行为主义：基于实证主义，观察行为理性选择：微观个体 “理论”一词的狭义定义：系统化解释，对一种规律的表述；描述性，解释性，预测性 第五单元 现代国际体系的基础国际体系：由诸多相互作用的国际行为体组合而成的整体现代国际体系 无序（无政府anarchy）- 国家间的竞争 资本主义在全球的扩张 民族国家的形成背景： 欧洲的政治割据与军事竞争 持久性和残酷性军事竞争与国家：国家组织的职业化与专业化 国家自主性与能力提升 国家形式的同化趋势 概念：多种称谓：民族国家、现代国家、有机国家民族国家：民族主义加强国内凝聚力现代国家：强调统治力更强有机国家：结构（国家、社会）分明，能够互相促进发展传统定义： 一系列机构 全职行政官员 特定的地域 对暴力工具的合法垄断 对控制一定领土的机构以及定居在这片领土上的人的合法抽象 核心特点：统治力与主权两层含义： 国内层面：国家组织与国家机构的总称，与社会相对（强调统治力） 国际层面：一定领土内人与机构的总称，与其他主权国家相对（强调主权） 欧洲早期的经济形态：自给自足的生产方式（互补性贸易）远程贸易与地方贸易从互补性贸易到竞争性贸易（市场经济） 市场经济的概念多种称谓：市场经济、资本主义经济、现代经济传统定义：商品生产、生产资料的私人垄断占有、劳动力的自由买卖及其生产资料的分离核心特点：专业化生产与贸易核心动力：中心-边缘关系的形成与扩展 资本主义的扩张是欧洲国际体系生长扩张的动力 第六单元 现代国际体系的形成持续军事竞争与民族国家对竞争性市场的推动：早期欧洲的政治经济形态 政治：分裂与割据；军事竞争的持久性与残酷性 经济形态：自给自足的生产方式；远程贸易与地方贸易，互补性贸易持续的军事竞争与国家强化的无意识结果：竞争性市场的开辟持续的军事竞争与国家对财政的持续追求： 推动更有效率的生产方式 保护产权 - 税收与议会 促进资本积累 重点：市场经济、资本主义道路是在残酷的军事竞争中萌发的 市场经济对民族国家的反作用 市场经济对民族国家提供的财富与科技支持使军事竞争不断升级 市场经济通过中心-边缘关系带动民族国家向外扩张（不断寻找更廉价资源） 军事竞争与示范效应：民族国家与市场经济的推广 民族国家与市场经济的持续互动 现代国际体系的延续与扩张 均势（balance of power）：保证体系的延续 均势的历史威斯特伐利亚体系（现代国际体系形成的标志）拿破仑帝国的兴衰维也纳体系普鲁士-德国的崛起第一次世界大战凡尔赛-华盛顿体系第二次世界大战苏美两极体系中心-边缘关系的扩张 英国的崛起（英国体系） 体系背景：政经力量的不平衡发展 国家力量与社会力量的妥协与合力-宪政主义政体 国内机制：与西班牙、法国的比较-优势：公债系统（可作为现代国家诞生的标志）、宪政主义政体…… 海外扩张：与葡萄牙、荷兰的比较 荷兰（高级消费品、互补性贸易）vs 英国（一般消费品）- 英国依靠持续输送大众消费品取得强权 英国的政策： 早期重商主义政策：促进出口限制进口；关税，限制自由贸易 1846年废除谷物法，自由贸易 对外经济战略 对殖民地：限制产业 对半独立国家：坚船利炮强行贸易 对主要竞争者：限制人口流动等 中心边缘关系：原材料贸易（中心和边缘）、同质产品竞争（中心和中心） 小结： 民族国家与市场经济相辅相成、缺一不可 军事竞争、示范效应、持续互动与现代国际体系的形成 均势与国际体系的延续 中心-边缘关系与现代国际体系的扩张 国家、社会力量的妥协与英国的崛起 英国体系的崛起 第七单元 现代国际体系的演变英国体系的衰落： 背景 市场经济的全面发展 “多极”结构与“体系重合”多极：英国海上霸权，陆军较弱，霸主地位不突出体系重合：市场经济体系与民族国家竞争体系重合 自由主义贸易与国际货币体系的衰落 民族国家与贸易保护 国家货币：贸易需求量的增多 国际货币机制：金本位（货币量与黄金存储量相对应）与自动调节机制（黄金内流-发行货币量增加-通货膨胀-黄金外流-货币量减小-通货紧缩-黄金内流） 体系范围的“通货收缩趋势”与经济危机（1873-1896世界性危机、1920大萧条象征英国体系的崩溃 凯恩斯主义） 英国的衰落 国际负担与国内制度 国家利益（经济调整）与体系维持（汇率稳定）的矛盾；金融资产阶级（希望维持汇率稳定与工业资产阶级（希望维持国内经济）； 英国的选择：维持体系，最终导致国内崩溃、体系瓦解 世纪之交的大转型：资本主义对社会的全面入侵 复习：资本主义的特点 专业化生产与贸易 生产资料的私有垄断 生产力也可作为商品买卖 自给自足生产方式下的社会组织：社会关系（家族、血缘）与经济密不可分资本主义对社会的微观入侵：对血缘等社会关系的彻底颠覆（将生产力作为商品买卖）资本主义对社会的宏观入侵：英国体系的货币机制与经济危机 社会对资本主义的反弹传统自由主义政体的危局左（共产主义社会主义无政府主义）右（法西斯主义）翼政治力量的崛起间接引发第二次世界大战 双重运动（double movement）：资本主义对社会的全面入侵必将引起社会的反弹 美国体系： 二战之后美国成为霸主 对现代国际体系的修复：福利国家（welfare state）嵌入式自由主义（embedded liberalism）：解决通货膨胀和紧缩 国际货币组织 从体系重合到体系分离：美苏两极结构的确立与核武器的作用（保持军事平衡和相对稳定）"},{"title":"题解:P2231 跳蚤","path":"/2024/03/16/题解-P2231-跳蚤/","content":"题解：P2231 [HNOI2002] 跳蚤P2231 [HNOI2002] 跳蚤 - 洛谷 原问题等价于求解关于 的不定方程 的解个数。 很显然, 原方程当且仅当 时有解。 正难则反,即用 减去 的情况。 设 则 。考虑到 ，有 种 。 所以，对于 的因数 ，共有 种方式使得答案有解。 考虑能不能只考虑 的质因数的贡献。如果直接把 的质因数的贡献加起来显然可能出现同一个质因数被算进其他质因数的贡献里。考虑容斥原理。 令全集 为 的所有质因数，则 。 直接 dfs 或者 状压 即可，最终答案为 。 注意到 即 中最多含有 个元素。因此容斥时间复杂度 但考虑到需要分解质因数，因此总复杂度 。 给出关键代码: for(ll mask = 1; mask (1 k); mask++) { ll sum = 1; int cnt = 0; for(int i = 1; i = k; i++) if(mask (1ll (i - 1))) cnt++, sum *= prime[i]; if(cnt % 2 == 0) ans -= qpow(m / sum, n); else ans += qpow(m / sum, n);}","tags":["题解"]},{"title":"线段树优化建图","path":"/2024/03/10/算法笔记-线段树优化建图/","content":"线段树优化建图三种操作: 从 到 建一条边 从 到 内的每一个点都建一条边 从 内的每一个点都向 建一条边 点数,操作数 显然, 的暴力建边会 , 那么怎么优化? 看到区间显然会想到线段树 考虑到一个区间在线段树上最多可以表示成 个节点, 可以考虑建边时直接指向线段树上的节点。 建树 建立两棵线段树: 一棵入树负责管理边的终点 一棵出树负责管理边的起点 因为两棵树的叶子节点本是同一个节点,因此用边权为0的双向边连接。 入树建树时因从父亲向儿子连边权为0的有向边,出树则应从儿子连向父亲。 算法流程 考虑第二个操作:从 到 内的每一个点都建一条边。很显然,应从出树的叶子节点向入树的区间连边。 例:从 到 连边,就在线段树区间修改的递归途中边递归边连边 考虑第三个操作:从 内的每一个点都向 建一条边。跟操作二一样,应从出树的区间向入树的叶子节点连边。 例:从 到 连边。 这样,我们就解决了建图。可以证明，这样连边建出的图和原来的图没有区别。注意，两棵线段树叶子节点之间的边以及从父亲到儿子、从儿子到父亲的边是必不可少的。建图时间复杂度 。 模板题CF786B Legacy 建图直接运用上述算法即可。 跑最短路时注意以下几点: 需要记录每个原始节点在两棵线段树中分别的位置,以供进行2,3操作 进行操作时需要在记录的线段树上的位置上操作 连边时注意方向以及叶子节点之间的边、父亲到儿子、儿子到父亲的边,这样跑出来的最短路才是对的 代码见 线段树优化建图模板","tags":["算法笔记"]},{"title":"Hello World","path":"/2024/03/02/hello-world/","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post$ hexo new My New Post More info: Writing Run server$ hexo server More info: Server Generate static files$ hexo generate More info: Generating Deploy to remote sites$ hexo deploy More info: Deployment"}]