[{"title":"二项式反演","path":"/2024/04/13/算法笔记-二项式反演/","content":"# 二项式反演介绍设 为恰好使用 个元素满足某条件的方案数， 为 个元素中选 个满足某条件其余元素随意的方案数。 显然 。那么，若已知 ，需求 ，有如下反演公式： 证明 将 展开 交换求和顺序： 根据 可得： 发现 是一个二项式定理， 因此： 证毕。 两种常见形式 形式一：设 为恰好使用 个元素满足某条件的方案数， 为 个元素中选 个满足某条件的方案数。 形式二：设 为 个元素中恰好有 个满足条件的方案数， 为 个元素中有 个满足条件其余随意的方案数。 例题错排问题 给定 ，求长度为 的序列的错排数量。 设 为恰好有 个位置错开， 为至多有 个位置错开 容易发现 ，则运用形式一反演可得：。 预处理组合数，时间复杂度 。 P4859 已经没有什么好害怕的了 给定长度为 的两个序列 ，将 中的元素和 中的一一配对，求有多少种方案使得 ĵ 的对数比 的对数恰好多 组。 设 表示 的对数，因此 ，解得 。 先将 和 按升序排序。考虑 dp，设 表示 中小于 的元素个数， 表示 已经匹配好，有至少 个位置满足 的方案数。 考虑转移，可以从 转移；另一种是从 转移，因为 是升序的，所以第 位能选的方案数是 。 由于 中我们只考虑了 的位置，其他位置可以随便排，因此设 。 运用形式二反演可得：。答案即为 ，时间复杂度 。","tags":["算法笔记"]},{"title":"题解:P2231 跳蚤","path":"/2024/03/16/题解-P2231-跳蚤/","content":"题解：P2231 [HNOI2002] 跳蚤P2231 [HNOI2002] 跳蚤 - 洛谷 原问题等价于求解关于 的不定方程 的解个数。 很显然, 原方程当且仅当 时有解。 正难则反,即用 减去 的情况。 设 则 。考虑到 ，有 种 。 所以，对于 的因数 ，共有 种方式使得答案有解。 考虑能不能只考虑 的质因数的贡献。如果直接把 的质因数的贡献加起来显然可能出现同一个质因数被算进其他质因数的贡献里。考虑容斥原理。 令全集 为 的所有质因数，则 。 直接 dfs 或者 状压 即可，最终答案为 。 注意到 即 中最多含有 个元素。因此容斥时间复杂度 但考虑到需要分解质因数，因此总复杂度 。 给出关键代码: 1234567for(ll mask = 1; mask &lt; (1 &lt;&lt; k); mask++) { ll sum = 1; int cnt = 0; for(int i = 1; i &lt;= k; i++) if(mask &amp; (1ll &lt;&lt; (i - 1))) cnt++, sum *= prime[i]; if(cnt % 2 == 0) ans -= qpow(m / sum, n); else ans += qpow(m / sum, n);}","tags":["题解"]},{"title":"线段树优化建图","path":"/2024/03/10/算法笔记-线段树优化建图/","content":"线段树优化建图三种操作: 从 到 建一条边 从 到 内的每一个点都建一条边 从 内的每一个点都向 建一条边 点数,操作数 显然, 的暴力建边会 , 那么怎么优化? 看到区间显然会想到线段树 考虑到一个区间在线段树上最多可以表示成 个节点, 可以考虑建边时直接指向线段树上的节点。 建树 建立两棵线段树: 一棵入树负责管理边的终点 一棵出树负责管理边的起点 因为两棵树的叶子节点本是同一个节点,因此用边权为0的双向边连接。 入树建树时因从父亲向儿子连边权为0的有向边,出树则应从儿子连向父亲。 算法流程 考虑第二个操作:从 到 内的每一个点都建一条边。很显然,应从出树的叶子节点向入树的区间连边。 例:从 到 连边,就在线段树区间修改的递归途中边递归边连边 考虑第三个操作:从 内的每一个点都向 建一条边。跟操作二一样,应从出树的区间向入树的叶子节点连边。 例:从 到 连边。 这样,我们就解决了建图。可以证明，这样连边建出的图和原来的图没有区别。注意，两棵线段树叶子节点之间的边以及从父亲到儿子、从儿子到父亲的边是必不可少的。建图时间复杂度 。 模板题CF786B Legacy 建图直接运用上述算法即可。 跑最短路时注意以下几点: 需要记录每个原始节点在两棵线段树中分别的位置,以供进行2,3操作 进行操作时需要在记录的线段树上的位置上操作 连边时注意方向以及叶子节点之间的边、父亲到儿子、儿子到父亲的边,这样跑出来的最短路才是对的 代码见 线段树优化建图模板","tags":["算法笔记"]},{"title":"20230303鲜花","path":"/2024/03/03/20230303鲜花/","content":"前两天考了两天的胜铉模拟，感觉要了。怎么办。我只会打暴力，还打错了。两试共六题一道都不会。感觉你们都能ak胜铉。不过没事，自信即巅峰！昨晚写一篇游记直接干了2h，我没实力。 少年站在篮球架下，看着操场上的两个人跑着笑着，打着闹着。学校十分寂静，夜幕即将降临，天空中闪耀着零星的星星。挥洒着，就这样走了，前往「远方」，前往深不可测。看着「浅谈」，不禁有些感动，看着「空白」的草稿纸，不禁有些迷茫，“你不会！”，不禁有些慌张。拿起笔，奋笔疾书。半个小时，强拉着的心绷不住了。睡大觉。又看见篮筐底下的少年，只不过不是「他」。一天还没过完，就已经过的这么快了。满天星斗。跑向他。激动。累得趴下。拿起笔。开始敲击键盘。结束。离开。 怪谈：数据结构是神仙的，数论是难的，组合是晕的，而信息物理题是一点也听不懂的。","tags":["鲜花"]},{"title":"Hello World","path":"/2024/03/02/hello-world/","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot; More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment"}]